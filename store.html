<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="theme-color" content="#e1e1e1" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0a0a0a" media="(prefers-color-scheme: dark)">
  <title>Store - Jorobean</title>
  <meta name="robots" content="index, follow" />
  <meta name="description" content="Shop Jorobean's exclusive collection of designer footwear">
  <link rel="canonical" href="https://jorobean.com/store" />

  <!-- Open Graph -->
  <meta property="og:title" content="Store | Jorobean">
  <meta property="og:description" content="Shop Jorobean's exclusive collection of designer footwear">
  <meta property="og:url" content="https://jorobean.com/store">
  <meta property="og:type" content="website">

  <!-- Favicons -->
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/footer.css">
  <link rel="stylesheet" href="css/store.css">
  <script src="js/scrollBehavior.js" defer></script>
  <script src="js/store.js" defer></script>
</head>
<body>
  <div class="logo-container">
    <a href="/" class="logo logo-centered">
      <img src="jorobean_logo.webp" alt="Jorobean Logo" style="width: 100%; height: auto;" class="logo-img" />
    </a>
    <a href="/" class="logo logo-corner">
      <img src="logo2.webp" alt="Jorobean Logo Corner" style="width: 100%; height: auto;" />
    </a>
    <div class="nav-group">
      <button id="cart-button" class="cart-button" aria-label="Shopping Cart">
        <span class="cart-count">0</span>
        ðŸ›’
      </button>
    </div>
  </div>

  <main>
    <div class="store-header">
      <h1>Store</h1>
      <p class="store-description">Exclusive collection of designer apparel</p>
    </div>
    
    <div class="store-content">
      <div class="products-grid" id="products-container">
        <div class="loading-spinner">
          <div class="spinner"></div>
          <p>Loading products...</p>
        </div>
      </div>
    </div>

    <!-- Cart Sidebar -->
    <div class="cart-sidebar" id="cart-sidebar">
      <div class="cart-header">
        <h2>Shopping Cart</h2>
        <button class="close-cart" aria-label="Close Cart">âœ•</button>
      </div>
      <div class="cart-items" id="cart-items">
        <!-- Cart items will be dynamically loaded here -->
      </div>
      <div class="cart-footer">
        <div class="cart-total">
          Total: <span id="cart-total">$0.00</span>
        </div>
        <button class="checkout-button" id="checkout-button">Proceed to Checkout</button>
      </div>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const productsContainer = document.getElementById('products-container');
      
      try {
        const response = await fetch('/.netlify/functions/printful/products');
        const products = await response.json();
        
        if (products.error) {
          throw new Error(products.error);
        }

        const productsHTML = products.map(product => {
          // Use a default image if thumbnail is null
          const imageUrl = product.thumbnail_url || 'https://via.placeholder.com/400x500?text=Coming+Soon';
          const productClasses = product.thumbnail_url ? 'product-card' : 'product-card coming-soon';
          
          return `
            <div class="${productClasses}" data-product-id="${product.id}">
              <div class="product-image-container">
                <img src="${imageUrl}" 
                     alt="${product.name}" 
                     class="product-image"
                     loading="lazy">
                ${!product.thumbnail_url ? '<div class="coming-soon-badge">Coming Soon</div>' : ''}
              </div>
              <div class="product-info">
                <h2 class="product-title">${product.name}</h2>
                <p class="product-variants">${product.variants} styles available</p>
                ${product.thumbnail_url ? 
                  `<button class="view-variants-btn" onclick="showVariants(${product.id})">
                     View Styles
                   </button>` :
                  `<button class="notify-btn" onclick="notifyMe(${product.id})">
                     Notify When Available
                   </button>`
                }
              </div>
            </div>
          `;
        }).join('');

        productsContainer.innerHTML = productsHTML || '<div class="no-products">No products available at the moment</div>';
      } catch (error) {
        console.error('Error loading products:', error);
        productsContainer.innerHTML = `
          <div class="error-message">
            <p>Sorry, we couldn't load the products at this time.</p>
            <p>Please try again later.</p>
          </div>
        `;
      }
    });

    function showVariants(productId) {
      // We'll implement this function when we add the variants modal
      alert('Product variants coming soon!');
    }

    function notifyMe(productId) {
      // We'll implement this function for the notification feature
      alert('Notification feature coming soon!');
    }
  </script>

  <footer id="footer" aria-label="Site copyright">
    <div id="copyright">Â© 2025 Jorobean â€” All rights reserved.</div>
    <nav class="footer-nav">
      <a href="https://www.jorobean.com/privacy">PRIVACY POLICY</a>
      <span class="footer-separator"> | </span>
      <a href="https://www.jorobean.com/terms">TERMS</a>
      <span class="footer-separator"> | </span>
      <a href="https://www.jorobean.com/contest">CONTEST</a>
      <span class="footer-separator"> | </span>
      <a href="https://www.jorobean.com/about">ABOUT</a>
    </nav>
  </footer>

  <!-- Cart Overlay -->
  <div class="cart-overlay" id="cart-overlay"></div>
</body>
</html>
